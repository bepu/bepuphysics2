#version 450

layout(location = 0) in vec3 varying_RayDirection;
layout(location = 1) flat in vec3 varying_Position;
layout(location = 2) flat in uint varying_PackedColor;
layout(location = 3) flat in vec4 varying_Orientation;
layout(location = 0) out vec3 out_var_SV_Target0;

void main()
{
    vec3 _71 = dFdx(varying_RayDirection);
    vec3 _72 = dFdy(varying_RayDirection);
    // EDIT: Adjusts for OpenGL screenspace.
    _72 = -_72;
    vec3 _74 = normalize(cross(_72, _71));
    float _87 = -varying_Orientation.w;
    float _91 = varying_Orientation.x + varying_Orientation.x;
    float _92 = varying_Orientation.y + varying_Orientation.y;
    float _93 = varying_Orientation.z + varying_Orientation.z;
    float _95 = varying_Orientation.x * _92;
    float _96 = varying_Orientation.x * _93;
    float _97 = varying_Orientation.y * _92;
    float _98 = varying_Orientation.y * _93;
    float _99 = varying_Orientation.z * _93;
    float _100 = _87 * _91;
    float _101 = _87 * _92;
    float _102 = _87 * _93;
    float _108 = 1.0 - (varying_Orientation.x * _91);
    mat3 _117 = mat3(vec3((1.0 - _97) - _99, _95 + _102, _96 - _101), vec3(_95 - _102, _108 - _99, _98 + _100), vec3(_96 + _101, _98 - _100, _108 - _97));
    vec3 _119 = _117 * (varying_RayDirection - varying_Position);
    vec3 _120 = _117 * _74;
    vec3 _126 = max(abs(_117 * _71), abs(_117 * _72)) * 0.5;
    float _127 = _119.x;
    float _128 = _126.x;
    float _129 = _127 - _128;
    float _130 = _127 + _128;
    float _131 = _130 - 0.004999999888241291046142578125;
    float _141 = _129 - 0.004999999888241291046142578125;
    float _161 = 1.0 - clamp((abs(_120.x) - 0.7070000171661376953125) * 333.337615966796875, 0.0, 1.0);
    float _162 = clamp(((0.00999999977648258209228515625 * (floor(_130 + 0.99500000476837158203125) + clamp(((_131 - floor(_131)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0))) - (0.00999999977648258209228515625 * (floor(_129 + 0.99500000476837158203125) + clamp(((_141 - floor(_141)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _130 - _129), 0.0, 1.0) * _161;
    float _163 = _119.y;
    float _164 = _126.y;
    float _165 = _163 - _164;
    float _166 = _163 + _164;
    float _167 = _166 - 0.004999999888241291046142578125;
    float _177 = _165 - 0.004999999888241291046142578125;
    float _197 = 1.0 - clamp((abs(_120.y) - 0.7070000171661376953125) * 333.337615966796875, 0.0, 1.0);
    float _199 = _119.z;
    float _200 = _126.z;
    float _201 = _199 - _200;
    float _202 = _199 + _200;
    float _203 = _202 - 0.004999999888241291046142578125;
    float _213 = _201 - 0.004999999888241291046142578125;
    float _233 = 1.0 - clamp((abs(_120.z) - 0.7070000171661376953125) * 333.337615966796875, 0.0, 1.0);
    float _237 = _162 + ((clamp(((0.00999999977648258209228515625 * (floor(_166 + 0.99500000476837158203125) + clamp(((_167 - floor(_167)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0))) - (0.00999999977648258209228515625 * (floor(_165 + 0.99500000476837158203125) + clamp(((_177 - floor(_177)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _166 - _165), 0.0, 1.0) * _197) * (1.0 - _162));
    float _240 = _237 + ((clamp(((0.00999999977648258209228515625 * (floor(_202 + 0.99500000476837158203125) + clamp(((_203 - floor(_203)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0))) - (0.00999999977648258209228515625 * (floor(_201 + 0.99500000476837158203125) + clamp(((_213 - floor(_213)) - 0.9900000095367431640625) * 100.0, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _202 - _201), 0.0, 1.0) * _233) * (1.0 - _237));
    float _241 = _129 * 0.20000000298023223876953125;
    float _242 = _130 * 0.20000000298023223876953125;
    float _243 = _242 - 0.0035000001080334186553955078125;
    float _253 = _241 - 0.0035000001080334186553955078125;
    float _268 = clamp(((0.007000000216066837310791015625 * (floor(_242 + 0.9965000152587890625) + clamp(((_243 - floor(_243)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0))) - (0.007000000216066837310791015625 * (floor(_241 + 0.9965000152587890625) + clamp(((_253 - floor(_253)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _242 - _241), 0.0, 1.0) * _161;
    float _269 = _165 * 0.20000000298023223876953125;
    float _270 = _166 * 0.20000000298023223876953125;
    float _271 = _270 - 0.0035000001080334186553955078125;
    float _281 = _269 - 0.0035000001080334186553955078125;
    float _297 = _201 * 0.20000000298023223876953125;
    float _298 = _202 * 0.20000000298023223876953125;
    float _299 = _298 - 0.0035000001080334186553955078125;
    float _309 = _297 - 0.0035000001080334186553955078125;
    float _327 = _268 + ((clamp(((0.007000000216066837310791015625 * (floor(_270 + 0.9965000152587890625) + clamp(((_271 - floor(_271)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0))) - (0.007000000216066837310791015625 * (floor(_269 + 0.9965000152587890625) + clamp(((_281 - floor(_281)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _270 - _269), 0.0, 1.0) * _197) * (1.0 - _268));
    float _330 = _327 + ((clamp(((0.007000000216066837310791015625 * (floor(_298 + 0.9965000152587890625) + clamp(((_299 - floor(_299)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0))) - (0.007000000216066837310791015625 * (floor(_297 + 0.9965000152587890625) + clamp(((_309 - floor(_309)) - 0.992999970912933349609375) * 142.8571319580078125, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _298 - _297), 0.0, 1.0) * _233) * (1.0 - _327));
    float _331 = _129 * 0.039999999105930328369140625;
    float _332 = _130 * 0.039999999105930328369140625;
    float _333 = _332 - 0.00200000009499490261077880859375;
    float _343 = _331 - 0.00200000009499490261077880859375;
    float _358 = clamp(((0.0040000001899898052215576171875 * (floor(_332 + 0.99800002574920654296875) + clamp(((_333 - floor(_333)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0))) - (0.0040000001899898052215576171875 * (floor(_331 + 0.99800002574920654296875) + clamp(((_343 - floor(_343)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _332 - _331), 0.0, 1.0) * _161;
    float _359 = _165 * 0.039999999105930328369140625;
    float _360 = _166 * 0.039999999105930328369140625;
    float _361 = _360 - 0.00200000009499490261077880859375;
    float _371 = _359 - 0.00200000009499490261077880859375;
    float _387 = _201 * 0.039999999105930328369140625;
    float _388 = _202 * 0.039999999105930328369140625;
    float _389 = _388 - 0.00200000009499490261077880859375;
    float _399 = _387 - 0.00200000009499490261077880859375;
    float _417 = _358 + ((clamp(((0.0040000001899898052215576171875 * (floor(_360 + 0.99800002574920654296875) + clamp(((_361 - floor(_361)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0))) - (0.0040000001899898052215576171875 * (floor(_359 + 0.99800002574920654296875) + clamp(((_371 - floor(_371)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _360 - _359), 0.0, 1.0) * _197) * (1.0 - _358));
    float _420 = _417 + ((clamp(((0.0040000001899898052215576171875 * (floor(_388 + 0.99800002574920654296875) + clamp(((_389 - floor(_389)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0))) - (0.0040000001899898052215576171875 * (floor(_387 + 0.99800002574920654296875) + clamp(((_399 - floor(_399)) - 0.995999991893768310546875) * 249.9999847412109375, 0.0, 1.0)))) / max(1.0000000116860974230803549289703e-07, _388 - _387), 0.0, 1.0) * _233) * (1.0 - _417));
    vec4 _441 = vec4(vec3(0.0500000007450580596923828125) * _420, _420) + ((vec4(vec3(0.07500000298023223876953125) * _330, _330) + (vec4(vec3(0.1500000059604644775390625) * _240, _240) * (1.0 - _330))) * (1.0 - _420));
    float _447 = dot(normalize(vec3(0.37000000476837158203125, 0.930000007152557373046875, 0.300000011920928955078125)), _74);
    out_var_SV_Target0 = (_441.xyz + (vec3(float(varying_PackedColor & 2047u) * 0.000488519784994423389434814453125, float((varying_PackedColor >> 11u) & 2047u) * 0.000488519784994423389434814453125, float(varying_PackedColor >> 22u) * 0.000977517105638980865478515625) * (1.0 - _441.w))) * ((vec3(0.125) + ((vec3(0.12800000607967376708984375, 0.28299999237060546875, 0.855000019073486328125) * clamp(_74.y, 0.0, 1.0)) * 0.300000011920928955078125)) + (vec3(1.0) * (clamp(_447, 0.0, 1.0) + (0.20000000298023223876953125 * clamp(-_447, 0.0, 1.0)))));
}

